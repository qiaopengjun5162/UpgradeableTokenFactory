# å®æˆ˜

## å®è·µå¯å‡çº§åˆçº¦åŠæœ€å°ä»£ç†

æŒ‘æˆ˜ä»¥é“¸å¸å·¥å‚ä¸ºä¾‹ï¼Œ ç†è§£å¯å‡çº§åˆçº¦çš„ç¼–å†™åŠæœ€å°ä»£ç†å¦‚ä½•èŠ‚çœ Gas ã€‚

å®ç°â¼€ä¸ªå¯å‡çº§çš„å·¥å‚åˆçº¦ï¼Œå·¥å‚åˆçº¦æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š

1. `deployInscription(string symbol, uint totalSupply, uint perMint)` ï¼Œè¯¥æ–¹æ³•ç”¨æ¥åˆ›å»º ERC20 tokenï¼Œï¼ˆæ¨¡æ‹Ÿé“­æ–‡çš„ deployï¼‰ï¼Œ symbol è¡¨ç¤º Token çš„åç§°ï¼ŒtotalSupply è¡¨ç¤ºå¯å‘è¡Œçš„æ•°é‡ï¼ŒperMint ç”¨æ¥æ§åˆ¶æ¯æ¬¡å‘è¡Œçš„æ•°é‡ï¼Œç”¨äºæ§åˆ¶`mintInscription`å‡½æ•°æ¯æ¬¡å‘è¡Œçš„æ•°é‡
2. `mintInscription(address tokenAddr)` ç”¨æ¥å‘è¡Œ ERC20 tokenï¼Œæ¯æ¬¡è°ƒç”¨ä¸€æ¬¡ï¼Œå‘è¡ŒperMintæŒ‡å®šçš„æ•°é‡ã€‚

è¦æ±‚ï¼š
â€¢ åˆçº¦çš„ç¬¬â¼€ç‰ˆæœ¬ç”¨æ™®é€šçš„ new çš„æ–¹å¼å‘è¡Œ ERC20 token ã€‚
â€¢ ç¬¬â¼†ç‰ˆæœ¬ï¼ŒdeployInscription åŠ å…¥ä¸€ä¸ªä»·æ ¼å‚æ•° price ` deployInscription(string symbol, uint totalSupply, uint perMint, uint price)` , price è¡¨ç¤ºå‘è¡Œæ¯ä¸ª token éœ€è¦æ”¯ä»˜çš„è´¹ç”¨ï¼Œå¹¶ä¸” ç¬¬â¼†ç‰ˆæœ¬ä½¿ç”¨æœ€å°ä»£ç†çš„æ–¹å¼ä»¥æ›´èŠ‚çº¦ gas çš„æ–¹å¼æ¥åˆ›å»º ERC20 tokenï¼Œéœ€è¦åŒæ—¶ä¿®æ”¹ mintInscription çš„å®ç°ä»¥ä¾¿æ”¶å–æ¯æ¬¡å‘è¡Œçš„è´¹ç”¨ã€‚





### é—®é¢˜

#### æŠ¥é”™

![image-20240728172115753](assets/image-20240728172115753.png)

#### è§£å†³

![image-20240728172010845](assets/image-20240728172010845.png)

### æµ‹è¯•è¾“å‡º

```shell
UpgradeableTokenFactory on î‚  main [!?] via ğŸ…’ base took 7.1s 
âœ forge test -vv              
[â ’] Compiling...
No files changed, compilation skipped

Ran 1 test for test/ERC20TokenTest.sol:ERC20TokenTest
[PASS] testERC20Functionality() (gas: 123304)
Logs:
  0x7c8999dC9a822c1f0Df42023113EDB4FDd543266

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 1.77ms (65.25Âµs CPU time)

Ran 2 tests for test/TokenFactoryV2Test.sol:CounterTest
[PASS] testTokenFactoryV2DeployInscriptionFunctionality() (gas: 2905306)
Logs:
  0x7c8999dC9a822c1f0Df42023113EDB4FDd543266
  deployInscription  msg.sender, address: 0x7c8999dC9a822c1f0Df42023113EDB4FDd543266

[PASS] testTokenFactoryV2MintInscriptionFunctionality() (gas: 3005234)
Logs:
  0x7c8999dC9a822c1f0Df42023113EDB4FDd543266
  deployInscription  msg.sender, address: 0x7c8999dC9a822c1f0Df42023113EDB4FDd543266

Suite result: ok. 2 passed; 0 failed; 0 skipped; finished in 2.03ms (724.08Âµs CPU time)

Ran 2 tests for test/Counter.t.sol:CounterTest
[PASS] testFuzz_SetNumber(uint256) (runs: 256, Î¼: 30977, ~: 31288)
[PASS] test_Increment() (gas: 31303)
Suite result: ok. 2 passed; 0 failed; 0 skipped; finished in 5.41ms (4.27ms CPU time)

Ran 3 tests for test/TokenFactoryV1Test.sol:TokenFactoryV1Test
[PASS] testTokenFactoryV1DeployInscriptionFunctionality() (gas: 2975098)
Logs:
  0x7c8999dC9a822c1f0Df42023113EDB4FDd543266
  deployInscription newToken:  0x8d2C17FAd02B7bb64139109c6533b7C2b9CADb81

[PASS] testTokenFactoryV1MintInscriptionFunctionality() (gas: 3070219)
Logs:
  0x7c8999dC9a822c1f0Df42023113EDB4FDd543266
  deployInscription newToken:  0x8d2C17FAd02B7bb64139109c6533b7C2b9CADb81

[PASS] testUpgradeability() (gas: 6348189)
Logs:
  0x7c8999dC9a822c1f0Df42023113EDB4FDd543266

Suite result: ok. 3 passed; 0 failed; 0 skipped; finished in 5.02s (5.02s CPU time)

Ran 4 test suites in 5.02s (5.03s CPU time): 8 tests passed, 0 failed, 0 skipped (8 total tests)

UpgradeableTokenFactory on î‚  main [!?] via ğŸ…’ base took 5.7s 
âœ 
```



## å‚è€ƒ

- [ERC1967Utils](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/proxy/ERC1967/ERC1967Utils.sol)
- [ERC1967Proxy](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/proxy/ERC1967/ERC1967Proxy.sol)
- 
- 